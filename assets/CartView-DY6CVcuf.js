import{c as R,j as e,u as K,r as h,C as X,m as U,B as A,a3 as te,R as D,G as Y,K as se,Q as B,I as ae,J as re,a4 as ne,a5 as ie,a6 as le,a7 as ce,t as oe,a8 as de,a9 as ue,a2 as me,aa as pe}from"./index-Be6Wn9WR.js";import{O as xe}from"./values-BqvQ8A6-.js";import{s as he}from"./tvs-BJd3oYTX.js";import{P as ge}from"./PriceLabel-DLLKks5N.js";import{b as fe,F as be,I as ve,S as je}from"./Select-B6BkUKW2.js";import{P as Ne}from"./Payments-Drs3VDhI.js";import{M as G}from"./MenuItem-CTuJMizi.js";import{S as Se}from"./SimCardDownloadOutlined-CJv9O_UC.js";import"./svgsFormas-D6KheN2d.js";import"./OutlinedInput-BrKDcSU7.js";import"./ownerWindow-HQd8M8dq.js";import"./Paper-o41togOu.js";import"./Modal--bBGLnm-.js";const ye=R(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),H=[{id:"img",label:"",disabledSort:!0},{id:"label",label:"Nombre"},{id:"qtt",label:"Cantidad",isNumeric:!0,disabledSort:!0},{id:"price",label:"Precio",isNumeric:!0},{id:"subtotal",label:"Subtotal",isNumeric:!0,disabledSort:!0}],W={total:0,base:0,percentage:0},J=10;function _e({downloading:d=!1,following:g=!1}){const m=K(),i=m.cart.value,[p,o]=h.useState(!0),[l,P]=h.useState([]),[S,q]=h.useState("price-asc"),[r,f]=h.useState(J),[n,y]=h.useState({...W}),v=l.slice(0,r),[j,z]=h.useState(structuredClone(i)),I=async()=>{o(!0);let t=Y.filter(a=>a.id in i);t=JSON.parse(JSON.stringify(t));const s=await se(t,m.db.value,"thumbnails");m.db.set(s),t.map(a=>a.priceData=B(a.priceData,g&&a.categorie[0]==="imanes",i[a.id])),P(t),o(!1)},E=(t,s)=>{var N;const a=s[t],c=typeof a=="string"?a:"-";switch(t){case"label":return e.jsxs("div",{children:[e.jsx("a",{href:"#buscar/"+s.id,title:"Ver producto",className:"max-xs:whitespace-normal hover:underline",children:s.label}),e.jsx("p",{className:"capitalize text-second text-neutral-500 dark:text-neutral-300",children:s.categorie.join(" > ")})]});case"img":const _=m.db.value[s.id];let L=!1;if(_.haveSvg&&s.forma){const x=xe[s.forma[0]];if(x&&x.icon&&(L=x.icon),s.forma[1]&&x.subs&&s.forma[1]in x.subs){const F=x.subs[s.forma[1]];F.icon&&(L=F.icon)}}return L?e.jsx(L,{className:"w-[50px] h-fit max-h-[50px] self-center"}):e.jsx(ae,{alt:`Imagen de ${s.label}`,className:"object-contain w-[50px] min-w-[50px] max-h-[50px]",src:_.thumbnails&&_.thumbnails[0]});case"categorie":return e.jsx("span",{className:"capitalize",children:s.categorie.join(" > ")});case"qtt":const T=j[s.id];return e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(fe,{name:String(s.id),"aria-label":"Cantidad",type:"number",size:"small",color:"warning",className:"w-24 text-prima",startAdornment:"x",endAdornment:e.jsx("span",{className:"px-1",children:((N=s==null?void 0:s.priceData)==null?void 0:N.salesUnit)||"U"}),inputProps:{min:0,"aria-label":"cantidad"},classes:{underline:"!border-custom1"},sx:{"&::before":{borderColor:"rgb(var(--color-customSwitch))"}},value:T?String(T):"",onChange:x=>b(x,s.id),onBlur:x=>C(x,s.id),onKeyDown:x=>w(x,s.id)}),e.jsx(A,{size:"small",color:"error",variant:"outlined",className:`hover:bg-[--variant-containedBg] hover:text-white${d?" hidden":""}`,title:"Quitar del carrito",onClick:()=>O(s.id),sx:{minWidth:0,px:.5},children:e.jsx(ye,{className:"h-5 w-fit"})})]});case"price":return e.jsx(ge,{itemData:s});case"subtotal":const Z=s.priceData.usePrice,ee=s.priceData.prices[Z];return D(Number(ee)*i[s.id]);default:return c}},u=(t,s)=>{const a=l.find(c=>c.id===s);if(a){const c=Number(t.value),N=structuredClone(i);a.priceData=B(a.priceData,g&&a.categorie[0]==="imanes",c),m.cart.set({...N,[s]:c})}},b=(t,s)=>{const a=l.find(N=>N.id===s);let c=Number(t.target.value);a&&c>0&&c<1&&a.priceData.salesDecimal&&!a.priceData.salesDecimal.includes(c)&&(c=1),z({...i,[s]:c})},C=(t,s)=>{const a=t.target;u(a,s)},w=(t,s)=>{if(t.key==="Enter"){const a=t.target;u(a,s)}},O=t=>{m.cart.add(t,0)},k=()=>{if(l.length>0){let t=structuredClone(W);l.forEach(s=>{const a=s.priceData.usePrice,c=s.priceData.prices[a],N=s.priceData.prices.base,_=i[s.id];t.total+=Number(c)*_,t.base+=N*_}),t.percentage=(t.base-t.total)/t.base,y(t)}},$=()=>{const t=r+J;f(t)},Q=t=>{var c;const s=((c=t.currentTarget.dataset)==null?void 0:c.column)||"price";let a="desc";S.includes("desc")&&(a="asc"),q(s+"-"+a)},V=()=>{if(S){const[t,s]=S.split("-"),a=l.sort(re(t,s));P(a)}};return h.useEffect(()=>{I()},[i]),h.useEffect(()=>{k()},[l]),h.useEffect(V,[S]),h.useEffect(()=>{d&&f(l.length)},[d]),p?e.jsx(X,{className:"place-self-center m-6"}):Object.keys(i).length<1?e.jsx("b",{className:"text-center text-xl p-4",children:"Sin art칤culos para mostrar."}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-neutral-400 text-start ps-2 font-semibold self-center",children:["Total de art칤culos: ",l.length]}),e.jsx(U.section,{variants:{hidden:{},visible:{transition:{delayChildren:.1,staggerChildren:.1}}},initial:"hidden",animate:"visible",className:`w-full sm:px-4 ${he}`,style:{overflowX:d?"visible":"auto",maxWidth:d?"none":"90vw",paddingBottom:d?"0":"0.5rem"},children:e.jsxs("table",{className:"w-full sm:min-w-[640px]",children:[e.jsx("thead",{className:"border-b-4 border-neutral-300",children:e.jsx("tr",{children:H.map(t=>e.jsxs("th",{className:`p-2 whitespace-nowrap${t!=null&&t.disabledSort?"":" cursor-pointer hover:opacity-80"}`,style:{textAlign:t!=null&&t.isNumeric?"end":"start"},"data-column":t.id,onClick:t!=null&&t.disabledSort?void 0:Q,children:[t.label,!(t!=null&&t.disabledSort)&&S.includes(t.id)?S.includes("desc")?" 游모":" 游몪":null]},t.id))})}),e.jsxs("tbody",{children:[v.map(t=>e.jsx(U.tr,{variants:{hidden:{opacity:0,x:100},visible:{opacity:1,x:0}},className:"even:text-custom2-10 dark:even:text-custom1 group hover:bg-secondary/20",children:H.map(s=>e.jsx("td",{className:"px-3 py-2 sm:px-1 group-hover:font-semibold whitespace-nowrap",style:{textAlign:s!=null&&s.isNumeric?"end":"start"},children:E(s.id,t)},s.id+"-"+t.id))},t.id)),e.jsxs("tr",{children:[e.jsx("td",{children:r<l.length&&e.jsx(A,{variant:"contained",className:"bg-custom1-2 text-custom2 hover:scale-105",title:"Mostrar mas",onClick:()=>$(),sx:{textTransform:"none",borderRadius:3,fontFamily:"unset",fontWeight:"bold"},children:"Siguientes"})}),e.jsx("td",{colSpan:4})]})]})]})}),l.length>0&&e.jsxs("section",{className:"self-end font-semibold px-4 text-end border-2 border-customSwitch/80 rounded-md p-2",children:[(n==null?void 0:n.percentage)>0&&e.jsxs("div",{children:[e.jsxs("b",{className:"text-danger",children:["-",te(n==null?void 0:n.percentage)]})," ",e.jsx("span",{className:"text-neutral-400 line-through",children:D(n==null?void 0:n.base)})]}),e.jsxs("span",{className:"text-customSwitch",children:["Total ",D(n==null?void 0:n.total)]})]})]})}const De=R(e.jsx("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"})),M={retiro:{label:"Voy a retirar",description_item:"Quiero pasar a retirar",description_select:"Debe coordinar cuando quiera pasar."},coordinar:{label:"Quiero coordinar",description_item:"Quiero saber cuando se hagan entregas en el centro",description_select:""},cadete:{label:"Mando a buscarlo",description_item:"Quiero enviar a que lo busquen",description_select:"Si es un Uber, se transfiere el pago antes de entregar."},envio:{label:"Env칤o",description_item:"Quiero que me lo env칤en",description_select:"Se transfiere el env칤o antes y se paga en la entrega."},envio_uber:{label:"Env칤o: Uber",description_item:"Quiero que me lo env칤en por Uber",description_select:"Se transfiere el pago + env칤o antes."},envio_online:{label:"Env칤o: Tienda Online",description_item:"Quiero intermediar con Mercado Libre",description_select:"Puede comprar y arreglar por medio de ML(se pagan comisiones)."},envio_encomienda:{label:"Env칤o: Encomienda",description_item:"Quiero arreglar un env칤o por correo",description_select:""}};function Ce({downloading:d=!1,entrega:g={value:"retiro",label:"",following:!1},setEntrega:m}){const i=M==null?void 0:M[g.value];return e.jsxs("div",{id:"presupuesto",className:`flex flex-col gap-4 ${d?"w-fit p-4":""}`,children:[e.jsx(ne,{id:"presupuesto_logo",className:"max-w-44 my-2"}),e.jsxs(be,{className:"w-full max-w-xs self-center",children:[e.jsx(ve,{id:"shipping-select-label",children:"Entrega"}),e.jsxs(je,{labelId:"shipping-select-label",id:"shipping-select",label:"Entrega",variant:"outlined",color:"warning",className:"font-[menulis] bg-content1",slotProps:{notchedOutline:{className:"border-2 border-customSwitch/80 rounded-lg"}},MenuProps:{slotProps:{paper:{className:"border-2 border-customSwitch/80 rounded-lg mt-1 bg-background"}}},value:g.value,onChange:p=>{const o=p.target.value?String(p.target.value):"retiro",l={...g};l.value=o,l.label=i==null?void 0:i.label,m(l)},children:[e.jsx(G,{className:"italic font-[menulis] text-neutral-500 dark:text-neutral-300",children:"Seleccione"}),Object.entries(M).map(([p,o])=>e.jsxs(G,{value:p,className:"flex flex-col items-start max-w-xs font-[menulis] ",children:[e.jsx("b",{children:o==null?void 0:o.label}),(o==null?void 0:o.description_item)&&e.jsx("p",{className:"text-xs whitespace-normal text-neutral-500 dark:text-neutral-300",children:o==null?void 0:o.description_item})]},p))]}),(i==null?void 0:i.description_select)&&e.jsx("p",{className:"text-xs text-neutral-600 dark:text-neutral-300 mt-1",children:i==null?void 0:i.description_select})]}),e.jsx(_e,{downloading:d,following:g.following}),e.jsxs("section",{className:"flex flex-col items-center gap-2 text-neutral-500 text-center",children:[e.jsxs("div",{className:"w-full flex flex-wrap items-center justify-center gap-3",children:[e.jsx(Ne,{className:"h-6 w-fit"}),e.jsx(De,{className:"h-6 w-fit"}),e.jsx(ie,{className:"h-6 w-fit"}),e.jsx(le,{className:"h-6 w-fit"}),e.jsx(ce,{className:"h-5 w-fit"})]}),e.jsx(oe,{className:"w-2/3 bg-neutral-500/50"}),e.jsx("p",{children:"Gracias por su compra."}),d&&e.jsx("p",{children:d})]})]})}function Ae(){const d=K(),g=d.cart.value,[m,i]=h.useState(!1),[p,o]=h.useState({value:"retiro",label:"Voy a retirar",following:!1}),l=()=>{var E;const r=[`Hola. Me interesa hacer este pedido:
`];r.push(`*${p.label}
`),p.following&&r.push(`*Sigo las redes.
`);let f=0,n=Y.sort((u,b)=>u.label.localeCompare(b.label)).filter(u=>u.id in g);n=JSON.parse(JSON.stringify(n)),n.forEach(u=>{const b=[],C=g[u.id]||0,w=B(u.priceData,p.following&&u.categorie[0]==="imanes",C),O=w.usePrice,k=w.prices[O]||0,$=k*C,Q=u==null?void 0:u.label;f+=$,b.push(u.id+" -"),b.push(Q+" =>"),b.push(D(k)),b.push(`x${C}${w.salesUnit||"u"}`),b.push(`= ${D($)}`);const V=b.join(" ");r.push(V)});const y=D(f);r.push(`Total ${y}`);const v=r.join(`
`),j=encodeURIComponent(v),z=`${(E=d.links)==null?void 0:E.whatsapp}&text=${j}`,I=window.open(z,"_blank","noopener,noreferrer");I&&I.focus()},P=()=>{const r=new Date,f=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),y=String(r.getDate()).padStart(2,"0"),v=String(r.getHours()).padStart(2,"0"),j=String(r.getMinutes()).padStart(2,"0");return`${f}/${n}/${y}-${v}:${j}`},q=[{label:"Limpiar",title:"Limpiar lista",icon:de,color:"primary",onPress:()=>d.cart.set({})},{label:"Descargar",title:"Descargar como imagen",icon:Se,color:"secondary",onPress:async()=>{const r=document.querySelector("#presupuesto"),f=document.body.classList.contains("dark")?"black":"white";if(r){const n=P();i(!0);const y={backgroundColor:f,pixelRatio:2};setTimeout(async()=>{try{const v=await pe(r,y),j=document.createElement("a");j.href=v,j.download=`presupuesto-imanes_tucuman-${n}.png`,j.click()}catch(v){console.error("Error al generar la imagen:",v)}i(!1)},200)}}},{label:"Continuar",title:"Continuar por WhatsApp",icon:ue,color:"success",onPress:l}];return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"overflow-hidden max-xs:px-2 ",children:[e.jsx(Ce,{downloading:m,entrega:p,setEntrega:o}),m&&e.jsx("span",{className:"bg-black/50 absolute inset-0 z-10 flex items-center justify-center",children:e.jsx(X,{size:"lg",color:"secondary"})})]}),e.jsx("section",{className:"flex gap-2 max-xs:px-2 flex-wrap justify-center",children:q.map((r,f)=>{var n;return e.jsx(me,{title:r.title,arrow:!0,children:e.jsx("span",{children:e.jsx(A,{color:r.color,variant:"contained",disabled:((n=Object.keys(g))==null?void 0:n.length)<1||m,onClick:(r==null?void 0:r.onPress)||null,startIcon:e.jsx(r.icon,{className:"min-w-5 h-full"}),sx:{textTransform:"none",borderRadius:3,fontFamily:"unset",fontWeight:"bold"},children:r.label})})},f)})}),e.jsxs("section",{className:"text-center",children:[e.jsxs("p",{children:["Los pedidos de 500 o m치s unidades pueden conllevar una se침a y/o costo de env칤o y tiempo de espera.",e.jsx("br",{}),"Cuanto termine de revisar la lista envi칠 el pedido y ser치 redirigido a whatsapp para continuar."]}),e.jsxs("p",{className:"font-size-secondary text-neutral-500 dark:text-neutral-300 sm:hidden",children:[e.jsx("br",{}),"Si esta usando un dispositivo m칩vil y quiere descargar el pedido en una imagen es recomendable estar conectado a una red wifi dado que la imagen generada tendr치 un peso considerable."]})]})]})}export{Ae as default};
