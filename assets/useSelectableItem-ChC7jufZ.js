import{r as y,az as Ke,ar as me,at as Pe,aQ as re,y as V,Q as pe,bI as he,P as Se,aP as ye,N as se,R as ne,af as ce,ao as Te,bM as Fe}from"./index-VU69Q7-h.js";import{$ as ve,i as W,j as ge,k as be,l as ae,m as De,n as xe,e as ue,o as C}from"./SelectionManager-BVWtJyXP.js";import{$ as ke}from"./FocusScope-ZpBw4jPF.js";let we=0;const te=new Map;function Ee(i){let[t,e]=y.useState();return Ke(()=>{if(!i)return;let n=te.get(i);if(n)e(n.element.id);else{let s=`react-aria-description-${we++}`;e(s);let f=document.createElement("div");f.id=s,f.style.display="none",f.textContent=i,document.body.appendChild(f),n={refCount:0,element:f},te.set(i,n)}return n.refCount++,()=>{n&&--n.refCount===0&&(n.element.remove(),te.delete(i))}},[i]),{"aria-describedby":i?t:void 0}}const Ae=500;function Re(i){let{isDisabled:t,onLongPressStart:e,onLongPressEnd:n,onLongPress:s,threshold:f=Ae,accessibilityDescription:u}=i;const m=y.useRef(void 0);let{addGlobalListener:d,removeGlobalListener:T}=me(),{pressProps:B}=ve({isDisabled:t,onPressStart(a){if(a.continuePropagation(),(a.pointerType==="mouse"||a.pointerType==="touch")&&(e&&e({...a,type:"longpressstart"}),m.current=setTimeout(()=>{a.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),Pe(a.target).activeElement!==a.target&&re(a.target),s&&s({...a,type:"longpress"}),m.current=void 0},f),a.pointerType==="touch")){let P=p=>{p.preventDefault()};d(a.target,"contextmenu",P,{once:!0}),d(window,"pointerup",()=>{setTimeout(()=>{T(a.target,"contextmenu",P)},30)},{once:!0})}},onPressEnd(a){m.current&&clearTimeout(m.current),n&&(a.pointerType==="mouse"||a.pointerType==="touch")&&n({...a,type:"longpressend"})}}),v=Ee(s&&!t?u:void 0);return{longPressProps:V(B,v)}}function le(i){return he()?i.altKey:i.ctrlKey}function oe(i,t){var e,n;let s=`[data-key="${CSS.escape(String(t))}"]`,f=(e=i.current)===null||e===void 0?void 0:e.dataset.collection;return f&&(s=`[data-collection="${CSS.escape(f)}"]${s}`),(n=i.current)===null||n===void 0?void 0:n.querySelector(s)}const $e=new WeakMap;function Le(i){let t=pe();return $e.set(i,t),t}function Me(i){return $e.get(i)}const Oe=1e3;function Ce(i){let{keyboardDelegate:t,selectionManager:e,onTypeSelect:n}=i,s=y.useRef({search:"",timeout:void 0}).current,f=u=>{let m=Be(u.key);if(!(!m||u.ctrlKey||u.metaKey||!u.currentTarget.contains(u.target))){if(m===" "&&s.search.trim().length>0&&(u.preventDefault(),"continuePropagation"in u||u.stopPropagation()),s.search+=m,t.getKeyForSearch!=null){let d=t.getKeyForSearch(s.search,e.focusedKey);d==null&&(d=t.getKeyForSearch(s.search)),d!=null&&(e.setFocusedKey(d),n&&n(d))}clearTimeout(s.timeout),s.timeout=setTimeout(()=>{s.search=""},Oe)}};return{typeSelectProps:{onKeyDownCapture:t.getKeyForSearch?f:void 0}}}function Be(i){return i.length===1||!/^[A-Z]/i.test(i)?i:""}function ze(i){let{selectionManager:t,keyboardDelegate:e,ref:n,autoFocus:s=!1,shouldFocusWrap:f=!1,disallowEmptySelection:u=!1,disallowSelectAll:m=!1,escapeKeyBehavior:d="clearSelection",selectOnFocus:T=t.selectionBehavior==="replace",disallowTypeAhead:B=!1,shouldUseVirtualFocus:v,allowsTabNavigation:a=!1,isVirtualized:P,scrollRef:p=n,linkBehavior:H="action"}=i,{direction:w}=Se(),h=ye(),I=r=>{var o;if(r.altKey&&r.key==="Tab"&&r.preventDefault(),!(!((o=n.current)===null||o===void 0)&&o.contains(r.target)))return;const c=(l,L)=>{if(l!=null){if(t.isLink(l)&&H==="selection"&&T&&!le(r)){Te.flushSync(()=>{t.setFocusedKey(l,L)});let M=oe(n,l),ie=t.getItemProps(l);M&&h.open(M,r,ie.href,ie.routerOptions);return}if(t.setFocusedKey(l,L),t.isLink(l)&&H==="override")return;r.shiftKey&&t.selectionMode==="multiple"?t.extendSelection(l):T&&!le(r)&&t.replaceSelection(l)}};switch(r.key){case"ArrowDown":if(e.getKeyBelow){var b,S,K;let l=t.focusedKey!=null?(b=e.getKeyBelow)===null||b===void 0?void 0:b.call(e,t.focusedKey):(S=e.getFirstKey)===null||S===void 0?void 0:S.call(e);l==null&&f&&(l=(K=e.getFirstKey)===null||K===void 0?void 0:K.call(e,t.focusedKey)),l!=null&&(r.preventDefault(),c(l))}break;case"ArrowUp":if(e.getKeyAbove){var D,k,j;let l=t.focusedKey!=null?(D=e.getKeyAbove)===null||D===void 0?void 0:D.call(e,t.focusedKey):(k=e.getLastKey)===null||k===void 0?void 0:k.call(e);l==null&&f&&(l=(j=e.getLastKey)===null||j===void 0?void 0:j.call(e,t.focusedKey)),l!=null&&(r.preventDefault(),c(l))}break;case"ArrowLeft":if(e.getKeyLeftOf){var Y,Z,J;let l=t.focusedKey!=null?(Y=e.getKeyLeftOf)===null||Y===void 0?void 0:Y.call(e,t.focusedKey):null;l==null&&f&&(l=w==="rtl"?(Z=e.getFirstKey)===null||Z===void 0?void 0:Z.call(e,t.focusedKey):(J=e.getLastKey)===null||J===void 0?void 0:J.call(e,t.focusedKey)),l!=null&&(r.preventDefault(),c(l,w==="rtl"?"first":"last"))}break;case"ArrowRight":if(e.getKeyRightOf){var X,_,ee;let l=t.focusedKey!=null?(X=e.getKeyRightOf)===null||X===void 0?void 0:X.call(e,t.focusedKey):null;l==null&&f&&(l=w==="rtl"?(_=e.getLastKey)===null||_===void 0?void 0:_.call(e,t.focusedKey):(ee=e.getFirstKey)===null||ee===void 0?void 0:ee.call(e,t.focusedKey)),l!=null&&(r.preventDefault(),c(l,w==="rtl"?"last":"first"))}break;case"Home":if(e.getFirstKey){if(t.focusedKey===null&&r.shiftKey)return;r.preventDefault();let l=e.getFirstKey(t.focusedKey,C(r));t.setFocusedKey(l),l!=null&&(C(r)&&r.shiftKey&&t.selectionMode==="multiple"?t.extendSelection(l):T&&t.replaceSelection(l))}break;case"End":if(e.getLastKey){if(t.focusedKey===null&&r.shiftKey)return;r.preventDefault();let l=e.getLastKey(t.focusedKey,C(r));t.setFocusedKey(l),l!=null&&(C(r)&&r.shiftKey&&t.selectionMode==="multiple"?t.extendSelection(l):T&&t.replaceSelection(l))}break;case"PageDown":if(e.getKeyPageBelow&&t.focusedKey!=null){let l=e.getKeyPageBelow(t.focusedKey);l!=null&&(r.preventDefault(),c(l))}break;case"PageUp":if(e.getKeyPageAbove&&t.focusedKey!=null){let l=e.getKeyPageAbove(t.focusedKey);l!=null&&(r.preventDefault(),c(l))}break;case"a":C(r)&&t.selectionMode==="multiple"&&m!==!0&&(r.preventDefault(),t.selectAll());break;case"Escape":d==="clearSelection"&&!u&&t.selectedKeys.size!==0&&(r.stopPropagation(),r.preventDefault(),t.clearSelection());break;case"Tab":if(!a){if(r.shiftKey)n.current.focus();else{let l=ke(n.current,{tabbable:!0}),L,M;do M=l.lastChild(),M&&(L=M);while(M);L&&!L.contains(document.activeElement)&&re(L)}break}}},F=y.useRef({top:0,left:0});W(p,"scroll",P?void 0:()=>{var r,o,c,b;F.current={top:(c=(r=p.current)===null||r===void 0?void 0:r.scrollTop)!==null&&c!==void 0?c:0,left:(b=(o=p.current)===null||o===void 0?void 0:o.scrollLeft)!==null&&b!==void 0?b:0}});let U=r=>{if(t.isFocused){r.currentTarget.contains(r.target)||t.setFocused(!1);return}if(r.currentTarget.contains(r.target)){if(t.setFocused(!0),t.focusedKey==null){var o,c;let K=k=>{k!=null&&(t.setFocusedKey(k),T&&!t.isSelected(k)&&t.replaceSelection(k))},D=r.relatedTarget;var b,S;D&&r.currentTarget.compareDocumentPosition(D)&Node.DOCUMENT_POSITION_FOLLOWING?K((b=t.lastSelectedKey)!==null&&b!==void 0?b:(o=e.getLastKey)===null||o===void 0?void 0:o.call(e)):K((S=t.firstSelectedKey)!==null&&S!==void 0?S:(c=e.getFirstKey)===null||c===void 0?void 0:c.call(e))}else!P&&p.current&&(p.current.scrollTop=F.current.top,p.current.scrollLeft=F.current.left);if(t.focusedKey!=null&&p.current){let K=oe(n,t.focusedKey);K instanceof HTMLElement&&(!K.contains(document.activeElement)&&!v&&re(K),ce()==="keyboard"&&ue(K,{containingElement:n.current}))}}},E=r=>{r.currentTarget.contains(r.relatedTarget)||t.setFocused(!1)},g=y.useRef(!1);W(n,ge,v?r=>{let{detail:o}=r;r.stopPropagation(),t.setFocused(!0),(o==null?void 0:o.focusStrategy)==="first"&&(g.current=!0)}:void 0);let A=se(()=>{var r,o;let c=(o=(r=e.getFirstKey)===null||r===void 0?void 0:r.call(e))!==null&&o!==void 0?o:null;c==null?(be(n.current),t.collection.size>0&&(g.current=!1)):(t.setFocusedKey(c),g.current=!1)});ae(()=>{g.current&&A()},[t.collection,A]);let O=se(()=>{t.collection.size>0&&(g.current=!1)});ae(()=>{O()},[t.focusedKey,O]),W(n,De,v?r=>{var o;r.stopPropagation(),t.setFocused(!1),!((o=r.detail)===null||o===void 0)&&o.clearFocusKey&&t.setFocusedKey(null)}:void 0);const N=y.useRef(s),x=y.useRef(!1);y.useEffect(()=>{if(N.current){var r,o;let S=null;var c;s==="first"&&(S=(c=(r=e.getFirstKey)===null||r===void 0?void 0:r.call(e))!==null&&c!==void 0?c:null);var b;s==="last"&&(S=(b=(o=e.getLastKey)===null||o===void 0?void 0:o.call(e))!==null&&b!==void 0?b:null);let K=t.selectedKeys;if(K.size){for(let D of K)if(t.canSelectItem(D)){S=D;break}}t.setFocused(!0),t.setFocusedKey(S),S==null&&!v&&n.current&&ne(n.current),t.collection.size>0&&(N.current=!1,x.current=!0)}});let $=y.useRef(t.focusedKey),R=y.useRef(null);y.useEffect(()=>{if(t.isFocused&&t.focusedKey!=null&&(t.focusedKey!==$.current||x.current)&&p.current&&n.current){let r=ce(),o=oe(n,t.focusedKey);if(!(o instanceof HTMLElement))return;(r==="keyboard"||x.current)&&(R.current&&cancelAnimationFrame(R.current),R.current=requestAnimationFrame(()=>{p.current&&(xe(p.current,o),r!=="virtual"&&ue(o,{containingElement:n.current}))}))}!v&&t.isFocused&&t.focusedKey==null&&$.current!=null&&n.current&&ne(n.current),$.current=t.focusedKey,x.current=!1}),y.useEffect(()=>()=>{R.current&&cancelAnimationFrame(R.current)},[]),W(n,"react-aria-focus-scope-restore",r=>{r.preventDefault(),t.setFocused(!0)});let z={onKeyDown:I,onFocus:U,onBlur:E,onMouseDown(r){p.current===r.target&&r.preventDefault()}},{typeSelectProps:q}=Ce({keyboardDelegate:e,selectionManager:t});B||(z=V(q,z));let G;v||(G=t.focusedKey==null?0:-1);let Q=Le(t.collection);return{collectionProps:V(z,{tabIndex:G,"data-collection":Q})}}function Ve(i){let{id:t,selectionManager:e,key:n,ref:s,shouldSelectOnPressUp:f,shouldUseVirtualFocus:u,focus:m,isDisabled:d,onAction:T,allowsDifferentPressOrigin:B,linkBehavior:v="action"}=i,a=ye();t=pe(t);let P=o=>{if(o.pointerType==="keyboard"&&le(o))e.toggleSelection(n);else{if(e.selectionMode==="none")return;if(e.isLink(n)){if(v==="selection"&&s.current){let c=e.getItemProps(n);a.open(s.current,o,c.href,c.routerOptions),e.setSelectedKeys(e.selectedKeys);return}else if(v==="override"||v==="none")return}e.selectionMode==="single"?e.isSelected(n)&&!e.disallowEmptySelection?e.toggleSelection(n):e.replaceSelection(n):o&&o.shiftKey?e.extendSelection(n):e.selectionBehavior==="toggle"||o&&(C(o)||o.pointerType==="touch"||o.pointerType==="virtual")?e.toggleSelection(n):e.replaceSelection(n)}};y.useEffect(()=>{n===e.focusedKey&&e.isFocused&&(u?be(s.current):m?m():document.activeElement!==s.current&&s.current&&ne(s.current))},[s,n,e.focusedKey,e.childFocusStrategy,e.isFocused,u]),d=d||e.isDisabled(n);let p={};!u&&!d?p={tabIndex:n===e.focusedKey?0:-1,onFocus(o){o.target===s.current&&e.setFocusedKey(n)}}:d&&(p.onMouseDown=o=>{o.preventDefault()});let H=e.isLink(n)&&v==="override",w=e.isLink(n)&&v!=="selection"&&v!=="none",h=!d&&e.canSelectItem(n)&&!H,I=(T||w)&&!d,F=I&&(e.selectionBehavior==="replace"?!h:!h||e.isEmpty),U=I&&h&&e.selectionBehavior==="replace",E=F||U,g=y.useRef(null),A=E&&h,O=y.useRef(!1),N=y.useRef(!1),x=o=>{if(T&&T(),w&&s.current){let c=e.getItemProps(n);a.open(s.current,o,c.href,c.routerOptions)}},$={ref:s};f?($.onPressStart=o=>{g.current=o.pointerType,O.current=A,o.pointerType==="keyboard"&&(!E||de())&&P(o)},B?($.onPressUp=F?void 0:o=>{o.pointerType==="mouse"&&h&&P(o)},$.onPress=F?x:o=>{o.pointerType!=="keyboard"&&o.pointerType!=="mouse"&&h&&P(o)}):$.onPress=o=>{if(F||U&&o.pointerType!=="mouse"){if(o.pointerType==="keyboard"&&!fe())return;x(o)}else o.pointerType!=="keyboard"&&h&&P(o)}):($.onPressStart=o=>{g.current=o.pointerType,O.current=A,N.current=F,h&&(o.pointerType==="mouse"&&!F||o.pointerType==="keyboard"&&(!I||de()))&&P(o)},$.onPress=o=>{(o.pointerType==="touch"||o.pointerType==="pen"||o.pointerType==="virtual"||o.pointerType==="keyboard"&&E&&fe()||o.pointerType==="mouse"&&N.current)&&(E?x(o):h&&P(o))}),p["data-collection"]=Me(e.collection),p["data-key"]=n,$.preventFocusOnPress=u,u&&($=V($,{onPressStart(o){o.pointerType!=="touch"&&(e.setFocused(!0),e.setFocusedKey(n))},onPress(o){o.pointerType==="touch"&&(e.setFocused(!0),e.setFocusedKey(n))}}));let{pressProps:R,isPressed:z}=ve($),q=U?o=>{g.current==="mouse"&&(o.stopPropagation(),o.preventDefault(),x(o))}:void 0,{longPressProps:G}=Re({isDisabled:!A,onLongPress(o){o.pointerType==="touch"&&(P(o),e.setSelectionBehavior("toggle"))}}),Q=o=>{g.current==="touch"&&O.current&&o.preventDefault()},r=e.isLink(n)?o=>{Fe.isOpening||o.preventDefault()}:void 0;return{itemProps:V(p,h||F||u&&!d?R:{},A?G:{},{onDoubleClick:q,onDragStartCapture:Q,onClick:r,id:t},u?{onMouseDown:o=>o.preventDefault()}:void 0),isPressed:z,isSelected:e.isSelected(n),isFocused:e.isFocused&&e.focusedKey===n,isDisabled:d,allowsSelection:h,hasAction:E}}function fe(){let i=window.event;return(i==null?void 0:i.key)==="Enter"}function de(){let i=window.event;return(i==null?void 0:i.key)===" "||(i==null?void 0:i.code)==="Space"}export{Ee as $,ze as a,Ve as b,Re as c,oe as d};
