import{$ as v,y as c,z as m,r as f}from"./index-CXXa9ZVt.js";import{$ as w,f as M,h as S,g as E}from"./SelectionManager-B0owTTfb.js";import{a as C}from"./useControlledState-Crt6phvO.js";function z(t,a){let{elementType:e="button",isDisabled:s,onPress:n,onPressStart:i,onPressEnd:l,onPressUp:d,onPressChange:r,preventFocusOnPress:b,allowFocusWhenDisabled:p,onClick:K,href:$,target:h,rel:x,type:y="button"}=t,o;e==="button"?o={type:y,disabled:s}:o={role:"button",href:e==="a"&&!s?$:void 0,target:e==="a"?h:void 0,type:e==="input"?y:void 0,disabled:e==="input"?s:void 0,"aria-disabled":!s||e==="input"?void 0:s,rel:e==="a"?x:void 0};let{pressProps:g,isPressed:P}=w({onPressStart:i,onPressEnd:l,onPressChange:r,onPress:n,onPressUp:d,onClick:K,isDisabled:s,preventFocusOnPress:b,ref:a}),{focusableProps:u}=v(t,a);p&&(u.tabIndex=s?-1:u.tabIndex);let k=c(u,g,m(t,{labelable:!0}));return{isPressed:P,buttonProps:c(o,k,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],"aria-current":t["aria-current"]})}}class _{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(a){let e=this.keyMap.get(a);var s;return e&&(s=e.prevKey)!==null&&s!==void 0?s:null}getKeyAfter(a){let e=this.keyMap.get(a);var s;return e&&(s=e.nextKey)!==null&&s!==void 0?s:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(a){var e;return(e=this.keyMap.get(a))!==null&&e!==void 0?e:null}at(a){const e=[...this.getKeys()];return this.getItem(e[a])}constructor(a,{expandedKeys:e}={}){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=a,e=e||new Set;let s=d=>{if(this.keyMap.set(d.key,d),d.childNodes&&(d.type==="section"||e.has(d.key)))for(let r of d.childNodes)s(r)};for(let d of a)s(d);let n=null,i=0;for(let[d,r]of this.keyMap)n?(n.nextKey=d,r.prevKey=n.key):(this.firstKey=d,r.prevKey=void 0),r.type==="item"&&(r.index=i++),n=r,n.nextKey=void 0;var l;this.lastKey=(l=n==null?void 0:n.key)!==null&&l!==void 0?l:null}}function O(t){let{onExpandedChange:a}=t,[e,s]=C(t.expandedKeys?new Set(t.expandedKeys):void 0,t.defaultExpandedKeys?new Set(t.defaultExpandedKeys):new Set,a),n=M(t),i=f.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),l=S(t,f.useCallback(r=>new _(r,{expandedKeys:e}),[e]),null);return f.useEffect(()=>{n.focusedKey!=null&&!l.getItem(n.focusedKey)&&n.setFocusedKey(null)},[l,n.focusedKey]),{collection:l,expandedKeys:e,disabledKeys:i,toggleKey:r=>{s(F(e,r))},setExpandedKeys:s,selectionManager:new E(l,n)}}function F(t,a){let e=new Set(t);return e.has(a)?e.delete(a):e.add(a),e}export{z as $,O as a};
